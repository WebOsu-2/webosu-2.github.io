!function(){"use strict";function e(e){e&&(e.setTargetAtTime||(e.setTargetAtTime=e.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return e(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var o=t?this.internal_createDelay(t):this.internal_createDelay();return e(o.delayTime),o},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.start?(t.internal_start=t.start,t.start=function(e,o,n){void 0!==n?t.internal_start(e||0,o,n):t.internal_start(e||0,o||0)}):t.start=function(e,t,o){t||o?this.noteGrainOn(e||0,t,o):this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},e(t.playbackRate),t},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return e(t.threshold),e(t.knee),e(t.ratio),e(t.reduction),e(t.attack),e(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return e(t.frequency),e(t.detune),e(t.Q),e(t.gain),t},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();return t.start?(t.internal_start=t.start,t.start=function(e){t.internal_start(e||0)}):t.start=function(e){this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},t.setPeriodicWave||(t.setPeriodicWave=t.setWaveTable),e(t.frequency),e(t.detune),t})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=webkitOfflineAudioContext)}(window);var actx=new AudioContext,sounds={toLoad:0,loaded:0,audioExtensions:["mp3","ogg","wav","webm"],whenLoaded:void 0,onProgress:void 0,onFailed:function(e,t){throw new Error("Audio could not be loaded: "+e)},load:function(e){console.log("Loading sounds..");var t=this;t.toLoad=e.length,e.forEach((function(e){var o=e.split(".").pop();if(-1!==t.audioExtensions.indexOf(o)){var n=makeSound(e,t.loadHandler.bind(t),!0,!1,t.onFailed);n.name=e,t[n.name]=n}else console.log("File type not recognized: "+e)}))},loadHandler:function(e){var t=this;t.loaded+=1,t.onProgress&&t.onProgress(100*t.loaded/t.toLoad,{url:e}),t.toLoad===t.loaded&&(console.log("Sounds finished loading"),t.toLoad=0,t.loaded=0,t.whenLoaded&&t.whenLoaded())}};function makeSound(e,t,o,n,a){var r={};return r.volumeNode=actx.createGain(),actx.createStereoPanner?r.panNode=actx.createStereoPanner():r.panNode=actx.createPanner(),r.delayNode=actx.createDelay(),r.feedbackNode=actx.createGain(),r.filterNode=actx.createBiquadFilter(),r.convolverNode=actx.createConvolver(),r.soundNode=null,r.buffer=null,r.source=e,r.loop=!1,r.playing=!1,r.loadHandler=void 0,r.panValue=0,r.volumeValue=1,r.startTime=0,r.startOffset=0,r.playbackRate=1,r.echo=!1,r.delayValue=.3,r.feebackValue=.3,r.filterValue=0,r.reverb=!1,r.reverbImpulse=null,r.play=function(){r.startTime=actx.currentTime,r.soundNode=actx.createBufferSource(),r.soundNode.buffer=r.buffer,r.soundNode.playbackRate.value=this.playbackRate,r.soundNode.connect(r.volumeNode),!1===r.reverb?r.volumeNode.connect(r.panNode):(r.volumeNode.connect(r.convolverNode),r.convolverNode.connect(r.panNode),r.convolverNode.buffer=r.reverbImpulse),r.panNode.connect(actx.destination),r.echo&&(r.feedbackNode.gain.value=r.feebackValue,r.delayNode.delayTime.value=r.delayValue,r.filterNode.frequency.value=r.filterValue,r.delayNode.connect(r.feedbackNode),r.filterValue>0?(r.feedbackNode.connect(r.filterNode),r.filterNode.connect(r.delayNode)):r.feedbackNode.connect(r.delayNode),r.volumeNode.connect(r.delayNode),r.delayNode.connect(r.panNode)),r.soundNode.loop=r.loop,r.soundNode.start(0,r.startOffset%r.buffer.duration),r.playing=!0},r.pause=function(){r.playing&&(r.soundNode.stop(0),r.startOffset+=actx.currentTime-r.startTime,r.playing=!1)},r.getPosition=function(){return actx.currentTime-r.startTime+r.startOffset},r.restart=function(){r.playing&&r.soundNode.stop(0),r.startOffset=0,r.play()},r.playFrom=function(e){r.playing&&r.soundNode.stop(0),r.startOffset=e,r.play()},r.setEcho=function(e,t,o){void 0===e&&(e=.3),void 0===t&&(t=.3),void 0===o&&(o=0),r.delayValue=e,r.feebackValue=t,r.filterValue=o,r.echo=!0},r.setReverb=function(e,t,o){void 0===e&&(e=2),void 0===t&&(t=2),void 0===o&&(o=!1),r.reverbImpulse=impulseResponse(e,t,o,actx),r.reverb=!0},r.fade=function(e,t){r.playing&&(r.volumeNode.gain.linearRampToValueAtTime(r.volumeNode.gain.value,actx.currentTime),r.volumeNode.gain.linearRampToValueAtTime(e,actx.currentTime+t))},r.fadeIn=function(e){r.volumeNode.gain.value=0,r.fade(1,e)},r.fadeOut=function(e){r.fade(0,e)},Object.defineProperties(r,{volume:{get:function(){return r.volumeValue},set:function(e){r.volumeNode.gain.value=e,r.volumeValue=e},enumerable:!0,configurable:!0},pan:{get:function(){return actx.createStereoPanner?r.panNode.pan.value:r.panValue},set:function(e){if(actx.createStereoPanner)r.panNode.pan.value=e;else{var t=e,o=1-Math.abs(t);r.panNode.setPosition(t,0,o),r.panValue=e}},enumerable:!0,configurable:!0}}),o&&loadSound(r,e,t,a),n&&decodeAudio(r,n,t,a),r}function loadSound(e,t,o,n){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.addEventListener("load",decodeAudio.bind(this,e,a,o,n)),a.send()}function decodeAudio(e,t,o,n){actx.decodeAudioData(t.response,(function(t){e.buffer=t,e.hasLoaded=!0,o&&o(e.source)}),(function(t){n&&n(e.source,t)}))}