function launchOSU(e,o,t){let n=-1;for(let s=0;s<e.tracks.length;++s)(e.tracks[s].metadata.BeatmapID==o||!e.tracks[s].mode&&e.tracks[s].metadata.Version==t)&&(n=s);if(console.log("launching",o,t),-1==n){console.error("no such track"),console.log("available tracks are:");for(let o=0;o<e.tracks.length;++o)console.log(e.tracks[o].metadata.BeatmapID,e.tracks[o].mode,e.tracks[o].metadata.Version);return}if(window.app)return;console.log("launching PIXI app");let s=window.visualViewport?window.visualViewport.height:window.innerHeight,r=window.app=new PIXI.Application({width:window.innerWidth,height:s,resolution:window.devicePixelRatio||1,autoDensity:!0});r.renderer.autoResize=!0,r.renderer.background.color=1118481,window.visualViewport?window.visualViewport.addEventListener("resize",(()=>{if(r&&r.renderer){let e=window.visualViewport.height||window.innerHeight;r.renderer.resize(window.innerWidth,e)}})):window.addEventListener("resize",(()=>{r&&r.renderer&&r.renderer.resize(window.innerWidth,window.innerHeight)}));let a=document.body.scrollTop;document.addEventListener("contextmenu",(function(e){return e.preventDefault(),!1})),document.body.classList.add("gaming"),window.gamesettings&&(window.gamesettings.refresh(),window.gamesettings.loadToGame()),game.showhwmouse&&!game.autoplay||(game.cursor=new PIXI.Sprite(Skin["cursor.png"]),game.cursor.anchor.x=game.cursor.anchor.y=.5,game.cursor.scale.x=game.cursor.scale.y=.3*game.cursorSize,game.stage.addChild(game.cursor)),game.autofullscreen&&document.documentElement.requestFullscreen();let i=document.getElementById("game-area");var m,d=document.getElementById("main-page"),u=document.getElementById("main-nav");i.appendChild(r.view),game.autoplay||game.autopilot?(i.classList.remove("shownomouse"),i.classList.remove("showhwmousemedium"),i.classList.remove("showhwmousesmall"),i.classList.remove("showhwmousetiny")):game.showhwmouse?(i.classList.remove("shownomouse"),game.cursorSize<.65?i.classList.add("showhwmousetiny"):game.cursorSize<.95?i.classList.add("showhwmousesmall"):i.classList.add("showhwmousemedium")):(i.classList.add("shownomouse"),i.classList.remove("showhwmousemedium"),i.classList.remove("showhwmousesmall"),i.classList.remove("showhwmousetiny")),d.setAttribute("hidden",""),u.setAttribute("style","display: none"),i.removeAttribute("hidden"),window.quitGame=function(){i.setAttribute("hidden",""),d.removeAttribute("hidden"),u.removeAttribute("style"),document.body.classList.remove("gaming"),document.body.scrollTop=a,game.cursor&&(game.stage.removeChild(game.cursor),game.cursor.destroy(),game.cursor=null),window.app.destroy(!0,{children:!0,texture:!1}),window.app=null,m=null,window.cancelAnimationFrame(window.animationRequestID)};var l=new Playback(window.game,e,e.tracks[n]);game.scene=l,l.onload=function(){let e=document.getElementsByTagName("audio");for(let o=0;o<e.length;++o)e[o].softstop()},l.load(),m=function(e){game.scene&&game.scene.render(e),game.cursor&&(game.cursor.x=game.mouseX/512*gfx.width+gfx.xoffset,game.cursor.y=game.mouseY/384*gfx.height+gfx.yoffset,game.cursor.bringToFront()),r.renderer.render(game.stage),window.animationRequestID=window.requestAnimationFrame(m)},window.animationRequestID=window.requestAnimationFrame(m)}function launchGame(e,o,t){let n=new zip.fs.FS;n.root.importBlob(e,(function(){let e=new Osu(n.root);e.ondecoded=function(){launchOSU(e,o,t)},e.onerror=function(){console.error("osu parse error")},e.load()}),(function(e){console.error("unzip failed")}))}