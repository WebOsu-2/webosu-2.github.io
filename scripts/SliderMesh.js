define([],(function(){class t extends PIXI.Container{constructor(t,s,i){super(),this.curve=t,this.geometry=function(t,s){let i=[];for(let s=0;s<t.length;++s)(0===s||Math.abs(t[s].x-t[s-1].x)>1e-5||Math.abs(t[s].y-t[s-1].y)>1e-5)&&i.push(t[s]);let e=[],o=[];e.push(i[0].x,i[0].y,i[0].t,0);for(let t=1;t<i.length;++t){let n=i[t].x,r=i[t].y,h=i[t].t,a=i[t-1].x,d=i[t-1].y,l=i[t-1].t,u=n-a,f=r-d,m=Math.hypot(u,f),p=s*-f/m,y=s*u/m;e.push(a+p,d+y,l,1),e.push(a-p,d-y,l,1),e.push(n+p,r+y,h,1),e.push(n-p,r-y,h,1),e.push(n,r,h,0);let x=5*t+1;o.push(x-6,x-5,x-1,x-5,x-1,x-3),o.push(x-6,x-4,x-1,x-4,x-1,x-2)}function n(t,i,n,r=0){let h=Math.atan2(e[4*i+1]-e[4*t+1],e[4*i]-e[4*t]),a=Math.atan2(e[4*n+1]-e[4*t+1],e[4*n]-e[4*t]);h>a&&(a+=2*Math.PI);let d=a-h,l=Math.ceil(64*Math.abs(d)/(2*Math.PI));d/=l;let u=i;for(let i=1;i<l;++i){e.push(e[4*t]+s*Math.cos(h+i*d),e[4*t+1]+s*Math.sin(h+i*d),r,1);let n=e.length/4-1;o.push(t,u,n),u=n}o.push(t,u,n)}n(0,1,2,i[0].t),n(5*i.length-5,5*i.length-6,5*i.length-7,i[i.length-1].t);for(let t=1;t<i.length-1;++t){let s=i[t].x-i[t-1].x,e=i[t].y-i[t-1].y,o=i[t+1].x-i[t].x;s*(i[t+1].y-i[t].y)-o*e>0?n(5*t,5*t-1,5*t+2):n(5*t,5*t+1,5*t-2)}return(new PIXI.Geometry).addAttribute("position",e,4).addIndex(o)}(t.curve,s),this.alpha=1,this.tintid=i,this.startt=0,this.endt=1,this.state=PIXI.State.for2d(),this.drawMode=PIXI.DRAW_MODES.TRIANGLES,this.blendMode=PIXI.BLEND_MODES.NORMAL,this._roundPixels=PIXI.settings.ROUND_PIXELS}initialize(t,s,i,e,o){this.ncolors=t.length,this.uSampler2=function(t,s,i){const e=.872,o=.015,n=200;let r=new Uint8Array(t.length*n*4);for(let h=0;h<t.length;++h){let a=void 0!==s?s:t[h],d=void 0!==i?i:16777215,l=(d>>16)/255,u=(d>>8&255)/255,f=(255&d)/255,m=1,p=(a>>16)/255,y=(a>>8&255)/255,x=(255&a)/255,c=1;for(let t=0;t<n;t++){let s,i,a,d,g=t/n;if(g>=e?(s=l,i=u,a=f,d=m):(s=p,i=y,a=x,d=c*(.5*g/e+.3)),s*=d,i*=d,a*=d,1-g<o&&(s*=(1-g)/o,i*=(1-g)/o,a*=(1-g)/o,d*=(1-g)/o),e-g>0&&e-g<o){let t=(e-g)/o;s=t*s+(1-t)*l*m,i=t*i+(1-t)*u*m,a=t*a+(1-t)*f*m,d=t*c+(1-t)*m}r[4*(h*n+t)]=255*s,r[4*(h*n+t)+1]=255*i,r[4*(h*n+t)+2]=255*a,r[4*(h*n+t)+3]=255*d}}return PIXI.Texture.fromBuffer(r,n,t.length)}(t,e,o),this.circle=function(t){let s=[],i=[];s.push(0,0,0,0);for(let e=0;e<64;++e){let o=2*Math.PI/64*e;s.push(t*Math.cos(o),t*Math.sin(o),0,1),i.push(0,e+1,(e+1)%64+1)}return(new PIXI.Geometry).addAttribute("position",s,4).addIndex(i)}(s),this.uniforms={uSampler2:this.uSampler2,alpha:1,dx:i.dx,dy:i.dy,ox:i.ox,oy:i.oy,texturepos:0},this.shader=PIXI.Shader.from("\n    precision mediump float;\n    attribute vec4 position;\n    varying float dist;\n    uniform float dx,dy,dt,ox,oy,ot;\n    void main() {\n        dist = position[3];\n        gl_Position = vec4(position[0], position[1], position[3] + 2.0 * float(position[2]*dt>ot), 1.0);\n        gl_Position.x = gl_Position.x * dx + ox;\n        gl_Position.y = gl_Position.y * dy + oy;\n    }","\n    precision mediump float;\n    varying float dist;\n    uniform sampler2D uSampler2;\n    uniform float alpha;\n    uniform float texturepos;\n    void main() {\n        gl_FragColor = alpha * texture2D(uSampler2, vec2(dist, texturepos));\n    }",this.uniforms)}resetTransform(t){this.uniforms.dx=t.dx,this.uniforms.dy=t.dy,this.uniforms.ox=t.ox,this.uniforms.oy=t.oy}_render(t){this._renderDefault(t)}_renderDefault(t){let s=this.shader;s.alpha=this.worldAlpha,s.update&&s.update(),t.batch.flush(),this.uniforms.alpha=this.alpha,this.uniforms.texturepos=this.tintid/this.ncolors,this.uniforms.dt=0,this.uniforms.ot=.5;let i=this.uniforms.ox,e=this.uniforms.oy;const o=t.gl;let n,r;o.clearDepth(1),o.clear(o.DEPTH_BUFFER_BIT),o.colorMask(!1,!1,!1,!1),t.state.set(this.state),t.state.setDepthTest(!0);const h=i=>{t.shader.bind(s),t.geometry.bind(i,s);let e=i.indexBuffer.data.BYTES_PER_ELEMENT;n=2===e?o.UNSIGNED_SHORT:o.UNSIGNED_INT,r=i.indexBuffer.data.length};if(0===this.startt&&1===this.endt)this.uniforms.dt=0,this.uniforms.ot=1,h(this.geometry),o.drawElements(this.drawMode,r,n,0);else if(1===this.endt){1!==this.startt&&(this.uniforms.dt=-1,this.uniforms.ot=-this.startt,h(this.geometry),o.drawElements(this.drawMode,r,n,0)),this.uniforms.dt=0,this.uniforms.ot=1;let t=this.curve.pointAt(this.startt);this.uniforms.ox+=t.x*this.uniforms.dx,this.uniforms.oy+=t.y*this.uniforms.dy,h(this.circle),o.drawElements(this.drawMode,r,n,0)}else if(0===this.startt){0!==this.endt&&(this.uniforms.dt=1,this.uniforms.ot=this.endt,h(this.geometry),o.drawElements(this.drawMode,r,n,0)),this.uniforms.dt=0,this.uniforms.ot=1;let t=this.curve.pointAt(this.endt);this.uniforms.ox+=t.x*this.uniforms.dx,this.uniforms.oy+=t.y*this.uniforms.dy,h(this.circle),o.drawElements(this.drawMode,r,n,0)}else console.error("can't snake both end of slider");o.depthFunc(o.EQUAL),o.colorMask(!0,!0,!0,!0),0===this.startt&&1===this.endt?o.drawElements(this.drawMode,r,n,0):1===this.endt?(1!==this.startt&&(o.drawElements(this.drawMode,r,n,0),this.uniforms.ox=i,this.uniforms.oy=e,this.uniforms.dt=-1,this.uniforms.ot=-this.startt,h(this.geometry)),o.drawElements(this.drawMode,r,n,0)):0===this.startt&&(0!==this.endt&&(o.drawElements(this.drawMode,r,n,0),this.uniforms.ox=i,this.uniforms.oy=e,this.uniforms.dt=1,this.uniforms.ot=this.endt,h(this.geometry)),o.drawElements(this.drawMode,r,n,0)),o.depthFunc(o.LESS),t.state.setDepthTest(!1),this.uniforms.ox=i,this.uniforms.oy=e}destroy(t){super.destroy(t),this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null}}return t}));